$(function(){"undefined"==typeof HDV&&(HDV={}),void 0===HDV.V2&&(HDV.V2={}),HDV.V2.PlayerMedium={isFavorited:!1,isInited:!1,callbackFavorite:null,Size:{Width:$(".boxplay img").width(),Height:$(".boxplay img").height()},isFlashPrevent:!1,name:"mediumplayer",Show:function(){$(".boxplayer-popup").css({visibility:"visible"}),HDV.V2.Info.InitSizePlayer(function(){(!detailConfig.isTrailer||detailConfig.isTrailer&&"PAUSED"==jwplayer(HDV.V2.PlayerMedium.name).getState())&&HDV.V2.Info.CheckTrailerAndPlay()})},Hide:function(){jwplayer(HDV.V2.PlayerMedium.name).getFullscreen()||($(".boxplayer-popup").css({visibility:"hidden"}),$("#"+HDV.V2.PlayerMedium.name).blur(),"PLAYING"!=jwplayer(HDV.V2.PlayerMedium.name).getState()&&"BUFFERING"!=jwplayer(HDV.V2.PlayerMedium.name).getState()||jwplayer(HDV.V2.PlayerMedium.name).pause())},IsShow:function(){return"visible"==$(".boxplayer-popup").css("visibility")},Favorite:function(i){if(!isLogined)return this.Hide(),void $("#login_link").trigger("click");this.isFlashPrevent=!0,this.callbackFavorite=i,$("#click-add-favorite-details").trigger("click")},RequiredLogin:function(){this.Hide(),$("#login_link").trigger("click")}},HDV.V2.errorChangeLevel=function(){isLogined?isHDVip||HDV.V2.Core.ShowNotice({title:"Thông báo",content:'<div>Bạn vui lòng mua VIP để xem được chất lượng này.</div><br/><div align="center"><input type="submit"  class="mybutton click-to-login" style="margin-right: 100px;" value="Mua Vip"><input type="submit"  class="mybutton click-to-close-login" value="ĐÓNG"></div>',afterShow:function(){$(".click-to-login").click(function(){$.fancybox.close(),$("#register_vip").trigger("click")}),$(".click-to-close-login").click(function(){$.fancybox.close()})}}):$("#login_link").trigger("click")},HDV.V2.Info={SetStylePage:function(){if(isShowAds){var i=$(".sectiondetail").position().left,e=$("#Header").height()+5;$(".adv-side-left").css({left:i-$(".adv-side-left").width()-10,top:e}),$(".adv-side-right").css({left:i+$(".sectiondetail").width()+10,top:e})}$(window).resize(function(){if(isShowAds){var i=$(".sectiondetail").position().left,e=$("#Header").height()+5;$(".adv-side-left").css({left:i-$(".adv-side-left").width()-10,top:e}),$(".adv-side-right").css({left:i+$(".sectiondetail").width()+10,top:e})}}),$(".tooltipthumb2").cluetip({local:!0,arrows:!0,dropShadow:!1,hoverIntent:!0,sticky:!0,mouseOutClose:"both",delayedClose:100,cluezIndex:1e4,width:280,arrowPixelAdded:185,closePosition:"top",positionBy:"auto",closeText:""})},loadDataPlay:function(){detailConfig.isTrailer?($(".playercontent").html("<div id='"+HDV.V2.PlayerMedium.name+"'></div>"),jwplayer(HDV.V2.PlayerMedium.name).setup({width:parseInt(HDV.V2.PlayerMedium.Size.Width),height:parseInt(HDV.V2.PlayerMedium.Size.Height),autostart:"true",playlist:[{title:"Trailer "+detailConfig.name,file:detailConfig.youtubeTrailer}]})):($(".playercontent").html("<div id='mediumplayer'></div>"),$.ajax({url:"get_movie_play_json",data:{movieid:detailConfig.mid,sequence:detailConfig.CurrentEpisode},dataType:"json",success:function(i){if(void 0===i.error||1!=i.error){void 0!==i.data.isLogin&&(isLogined=!0),void 0!==i.data.isVip&&(isHDVip=!0),void 0!==i.data.caplevel&&0==isHDVip&&(window.isLevelCap=i.data.caplevel);var e={androidhls:!0,autostart:!0,width:parseInt(HDV.V2.PlayerMedium.Size.Width),height:parseInt(HDV.V2.PlayerMedium.Size.Height),aspectratio:"16:9",captions:{backgroundOpacity:"20",fontsize:"28"},plugins:{},playlist:[{sources:[{file:i.data.playList,type:"hlsjs"}],tracks:[]}]};if(!isHDVip){var t="";try{t=HadarInstreamAd.getInstreamAdUrl(1054)}catch(i){t=""}var a="";try{a=HadarInstreamAd.getInstreamAdUrl(1057)}catch(i){a=""}var o="";try{o=HadarInstreamAd.getInstreamAdUrl(1059)}catch(i){o=""}var n="";try{n=HadarInstreamAd.getInstreamAdUrl(1058)}catch(i){n=""}e.plugins[FRONTEND_STATIC_URL+"/player/"+detailConfig.flashVersion+"/vast.js"]={},e.advertising={placement:{preroll:{slot:[{tag:t,tagBackup:o},{tag:a,tagBackup:o}]},midroll:{slot:[{tag:n,tagBackup:o},{tag:n,tagBackup:o},{tag:n,tagBackup:o},{tag:n,tagBackup:o}]},pausebanner:{slot:[{tag:"http://pubads.g.doubleclick.net/gampad/ads?sz=800x450&iu=/29309823/WM_Movie_Pause&ciu_szs&impl=s&gdfp_req=1&env=vp&output=xml_vast2&unviewed_position_start=1&url=[referrer_url]&correlator=[timestamp]",tagBackup:"http://pubads.g.doubleclick.net/gampad/ads?sz=800x450&iu=/29309823/WM_Movie_Pause_Faile&ciu_szs&impl=s&gdfp_req=1&env=vp&output=xml_vast2&unviewed_position_start=1&url=[referrer_url]&correlator=[timestamp]"}]},dropbanner:{slot:[{tag:"http://pubads.g.doubleclick.net/gampad/ads?sz=800x90&iu=/29309823/WM_Movie_Drop&ciu_szs&impl=s&gdfp_req=1&env=vp&output=xml_vast2&unviewed_position_start=1&url=[referrer_url]&correlator=[timestamp]",tagBackup:"http://pubads.g.doubleclick.net/gampad/ads?sz=800x90&iu=/29309823/WM_Movie_Drop_Faile&ciu_szs&impl=s&gdfp_req=1&env=vp&output=xml_vast2&unviewed_position_start=1&url=[referrer_url]&correlator=[timestamp]"}]}}}}if(i.data.subtitle)for(var r=0;r<i.data.subtitle.length;r++)0==r?e.playlist[0].tracks.push({default:!0,file:i.data.subtitle[r].source,crossdomain:!0,label:"Anh"==i.data.subtitle[r].label?"Tiếng Anh":"Việt"==i.data.subtitle[r].label?"Tiếng Việt":i.data.subtitle[r].label}):e.playlist[0].tracks.push({file:i.data.subtitle[r].source,crossdomain:!0,label:"Anh"==i.data.subtitle[r].label?"Tiếng Anh":"Việt"==i.data.subtitle[r].label?"Tiếng Việt":i.data.subtitle[r].label});jwplayer(HDV.V2.PlayerMedium.name).setup(e),jwplayer(HDV.V2.PlayerMedium.name).on("all",function(){$("#"+HDV.V2.PlayerMedium.name).addClass("jw-flag-small-player jw-flag-time-slider-above")})}else HDV.V2.Core.ShowNotice({title:"Thông báo",content:i.data,timeAutoHide:1e4})},error:function(i){}}))},InitSizePlayer:function(i){if(HDV.V2.PlayerMedium.isInited)"function"==typeof i&&i();else{$(window).height();HDV.V2.PlayerMedium.isInited=!0,$(document).keyup(function(i){$("#"+HDV.V2.PlayerMedium.name).is(":focus")||(27==i.keyCode?HDV.V2.PlayerMedium.Hide():32==i.keyCode&&("PAUSED"==jwplayer(HDV.V2.PlayerMedium.name).getState()?jwplayer(HDV.V2.PlayerMedium.name).play():jwplayer(HDV.V2.PlayerMedium.name).pause()))}),"function"==typeof i&&i()}},htmlEntities:function(i){return String(i).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},ShowTrailer:function(){$("#bt-view-trailer").click(function(){HDV.V2.PlayerMedium.Show()})},Rating:function(){$(".stars li").mouseover(function(){var i=Math.round($(this).attr("value"));$(this).parent().prev().css({width:10*i+"px"}),$(this).find(".stip").stop(!0,!0).fadeIn("fast")}).mouseout(function(){$(this).parent().prev().css({width:$(this).attr("data-old-width")+"px"}),$(this).find(".stip").stop(!0,!0).fadeOut("fast")}).click(function(){if(isLogined){var i=$(this).attr("data-id"),e=$(this).attr("value");$.post(FRONTEND_URL+"/danh-gia-phim.html",{movieid:i,vote:e},function(){}).success(function(i){try{i=JSON.parse(i)}catch(i){}if("0"==i.e){var e=10*Math.round(i.r.Rating/i.r.Votes);$(".rated").width(e),$(".stars li").attr({"data-old-width":e}),HDV.V2.Core.ShowNotice({title:"Thông báo",content:"Cảm ơn bạn đã đánh giá phim này.",timeAutoHide:3e3})}else HDV.V2.Core.ShowNotice({title:"Thông báo",content:i.r,timeAutoHide:3e3})})}else $("#login_link").trigger("click")})},ClickPlay:function(){$(".click-auto-play").click(function(){var i=$(this).attr("href"),e=$(this).attr("data-id");return $(this).hasClass("icon-play")?HDV.V2.autoplay.push(e):HDV.V2.autoplay.remove(e),window.location.href=i,!1})},AutoPlay:function(){HDV.V2.autoplay.checkExists(detailConfig.mid)&&!detailConfig.isTrailer&&HDV.V2.PlayerMedium.Show()},CheckFavoriteList:function(){isLogined?$.get(BASE_URL+"/danh-sach-id-yeu-thich.html",function(){}).success(function(i){try{i=JSON.parse(i)}catch(i){}"0"==i.e&&i.r.Total>0&&$.each(i.r.Data,function(i,e){e==detailConfig.mid&&(HDV.V2.PlayerMedium.isFavorited=!0)}),HDV.V2.PlayerMedium.isFavorited&&$("#click-add-favorite-details").removeClass("addfavour").addClass("deletefavour").text("Xóa khỏi phim yêu thích")}):HDV.V2.PlayerMedium.isFavorited=!1,$("#click-add-favorite-details").click(function(){var i=this;$(this).hasClass("addfavour")?$.post(BASE_URL+"/them-phim-yeu-thich.html",{MovieID:detailConfig.mid},function(){}).success(function(e){"0"==(e=JSON.parse(e,!0)).e?(HDV.V2.PlayerMedium.isFlashPrevent||HDV.V2.Core.ShowNotice({title:"Thông báo",content:e.r,timeAutoHide:3e3}),$(i).removeClass("addfavour").addClass("deletefavour").text("Xóa khỏi phim yêu thích"),HDV.V2.PlayerMedium.isFavorited=!0):HDV.V2.PlayerMedium.isFlashPrevent||HDV.V2.Core.ShowNotice({title:"Thông báo",content:e.r,timeAutoHide:3e3}),HDV.V2.PlayerMedium.isFlashPrevent=!1,"function"==typeof HDV.V2.PlayerMedium.callbackFavorite&&HDV.V2.PlayerMedium.callbackFavorite(),HDV.V2.PlayerMedium.callbackFavorite=null}):$.post(BASE_URL+"/xoa-phim-yeu-thich.html",{MovieID:detailConfig.mid},function(){}).success(function(e){"0"==(e=JSON.parse(e,!0)).e?(HDV.V2.PlayerMedium.isFlashPrevent||HDV.V2.Core.ShowNotice({title:"Thông báo",content:e.r,timeAutoHide:3e3}),$(i).addClass("addfavour").removeClass("deletefavour").text("Thêm vào phim yêu thích"),HDV.V2.PlayerMedium.isFavorited=!1):HDV.V2.PlayerMedium.isFlashPrevent||HDV.V2.Core.ShowNotice({title:"Thông báo",content:e.r,timeAutoHide:3e3}),HDV.V2.PlayerMedium.isFlashPrevent=!1,"function"==typeof HDV.V2.PlayerMedium.callbackFavorite&&HDV.V2.PlayerMedium.callbackFavorite(),HDV.V2.PlayerMedium.callbackFavorite=null})})},LoadingEpisode:{Config:{itemPerPage:0,episode:detailConfig.Episode,data:[],totalPage:0,currentPage:1,mid:0,defaultMid:detailConfig.mid,currentEpisode:detailConfig.CurrentEpisode},Databypage:function(){if(this.Config.episode>0){for(var i=(this.Config.currentPage-1)*this.Config.itemPerPage+1,e=i+this.Config.itemPerPage>this.Config.episode?this.Config.episode:i+this.Config.itemPerPage-1,t="",a=i;a<=e;a++)t+="<li><a href='"+(void 0==this.Config.data[a]?"javascript:;":this.Config.data[a])+"' class='"+("javascript:;"==this.Config.data[a]||void 0==this.Config.data[a]?" disable ":"")+(this.Config.currentEpisode==a?" active ":"")+"'>"+a+"</a></li>";$(".chap-paging .chappaging").html(t),$(".chap-paging").show()}},DataPaging:function(){var i=this,e="";if(this.Config.totalPage>1){e+="<li><a href='javascript:;' data-page='1' "+(1==this.Config.currentPage?'class="active"':"")+">1</a></li>";var t=this.Config.currentPage-2<2?2:this.Config.currentPage-2,a=this.Config.currentPage+2>this.Config.totalPage-1?this.Config.totalPage-1:this.Config.currentPage+2;t>2&&(e+="<li><a href='javascript:;' data-page='"+(t-1)+"'>...</a></li>");for(var o=t;o<=a;o++)e+="<li><a href='javascript:;' data-page='"+o+"' "+(o==this.Config.currentPage?'class="active"':"")+">"+o+"</a></li>";a<this.Config.totalPage-1&&(e+="<li><a href='javascript:;' data-page='"+(a+1)+"'>...</a></li>"),e+="<li><a href='javascript:;' data-page='"+this.Config.totalPage+"' "+(this.Config.totalPage==this.Config.currentPage?'class="active"':"")+">"+this.Config.totalPage+"</a></li>"}$(".chap-paging .paginglist").html(e),$(".chap-paging .paginglist li a").click(function(){$(this).hasClass("active")||(i.Config.currentPage=parseInt($(this).attr("data-page")),i.Databypage(),i.DataPaging())})},Init:function(i){var e=this;$.get(BASE_URL+"/lay-danh-sach-tap-phim.html",{id:this.Config.mid},function(){}).success(function(t){try{t=JSON.parse(t),e.Config.episode=parseInt(t.Episode),e.Config.data=t.LinkEpisodes,e.Config.currentPage=1}catch(i){}e.Config.mid==e.Config.defaultMid?e.Config.currentEpisode=detailConfig.CurrentEpisode:e.Config.currentEpisode=0,e.Config.totalPage=e.Config.episode%e.Config.itemPerPage==0?e.Config.episode/e.Config.itemPerPage:parseInt(e.Config.episode/e.Config.itemPerPage)+1;var a=detailConfig.CurrentEpisode>0?detailConfig.CurrentEpisode%e.Config.itemPerPage==0?detailConfig.CurrentEpisode/e.Config.itemPerPage:parseInt(detailConfig.CurrentEpisode/e.Config.itemPerPage)+1:1;void 0===i&&(e.Config.currentPage=a),e.Databypage(),e.DataPaging()})}},SeasonPaging:{Config:{itemPerPage:6,totalPage:0,totalItem:0,currentPage:1,focusIndex:0},Databypage:function(){if(this.Config.totalItem>0){var i=(this.Config.currentPage-1)*this.Config.itemPerPage,e=i+this.Config.itemPerPage>this.Config.totalItem?this.Config.totalItem:i+this.Config.itemPerPage;$(".seasonpaging li").hide(),$(".seasonpaging li").slice(i,e).show()}},DataPaging:function(){var i=this,e="";if(this.Config.totalPage>1){e+="<li><a href='javascript:;' data-page='1' "+(1==this.Config.currentPage?'class="active"':"")+">1</a></li>";var t=this.Config.currentPage-2<2?2:this.Config.currentPage-2,a=this.Config.currentPage+2>this.Config.totalPage-1?this.Config.totalPage-1:this.Config.currentPage+2;t>2&&(e+="<li><a href='javascript:;' data-page='"+(t-1)+"'>...</a></li>");for(var o=t;o<=a;o++)e+="<li><a href='javascript:;' data-page='"+o+"' "+(o==this.Config.currentPage?'class="active"':"")+">"+o+"</a></li>";a<this.Config.totalPage-1&&(e+="<li><a href='javascript:;' data-page='"+(a+1)+"'>...</a></li>"),e+="<li><a href='javascript:;' data-page='"+this.Config.totalPage+"' "+(this.Config.totalPage==this.Config.currentPage?'class="active"':"")+">"+this.Config.totalPage+"</a></li>"}$(".theseasonpaging .paginglist").html(e),$(".theseasonpaging .paginglist li a").click(function(){$(this).hasClass("active")||(i.Config.currentPage=parseInt($(this).attr("data-page")),i.Databypage(),i.DataPaging())})},Init:function(){var i=this;if(this.Config.totalItem=$(".seasonpaging li").length,this.Config.totalPage=this.Config.totalItem%i.Config.itemPerPage==0?this.Config.totalItem/i.Config.itemPerPage:parseInt(this.Config.totalItem/i.Config.itemPerPage)+1,HDV.V2.Info.LoadingEpisode.Config.itemPerPage=this.Config.totalItem>0?18:26,this.Config.totalPage>0){var e=$(".seasonpaging li[season-index='"+detailConfig.seasonIndex+"']").index(".seasonpaging li")+1,t=e>0?e%i.Config.itemPerPage==0?e/i.Config.itemPerPage:parseInt(e/i.Config.itemPerPage)+1:1;this.Config.currentPage=t,this.Databypage(),this.DataPaging()}$(".seasonpaging li a").click(function(){var i=$(this).attr("data-season");$(".seasonpaging li a").removeClass("active"),$(this).addClass("active"),HDV.V2.Info.LoadingEpisode.Config.mid=i,HDV.V2.Info.LoadingEpisode.Init(!1)})}},ToggleAds:function(){$(".btnoffadv").click(function(){if(isLogined){if(isHDVip)return $.post(BASE_URL+"/tat-mo-quang-cao.html",function(){}).success(function(i){try{i=JSON.parse(i)}catch(i){}"0"==i.e&&window.location.reload()}),!1;window.location.href=BASE_URL+"/dang-ky-hdvip.html"}else $("#login_link").trigger("click")})},ErrorBox:function(){var i=this;$(".btnerror").fancybox({helpers:{title:null},beforeClose:function(){},afterShow:function(){$("#error_film .error").text(""),i.LoadCaptchaError(),$(".refeshCaptcha_report").click(function(){i.LoadCaptchaError()}),$(".select-type-error").change(function(){"99"==$(this).val()?$(".row_content").show():$(".row_content").hide()}).trigger("change"),$("#click_send_error").click(function(){i.isNumber($("#textMinute").val())?"99"==$(".select-type-error").val()&&$(".row_content textarea").val().length<5?$("#error_film .error").text("Nội dung báo lỗi quá ngắn."):""!=$("#textCaptcha_report").val()?$.post(BASE_URL+"/thong-bao-loi.html",{errortype:$(".select-type-error").val(),errormsg:$(".row_content textarea").val(),minute:$("#textMinute").val(),captcha:$("#textCaptcha_report").val(),movieid:detailConfig.mid},function(){}).success(function(i){try{i=JSON.parse(i)}catch(i){}"0"==i.e?HDV.V2.Core.ShowNotice({title:"Thông báo",content:i.r,timeAutoHide:3e3}):$("#error_film .error").text(i.r)}):$("#error_film .error").text("Chưa nhập mã bảo vệ."):$("#error_film .error").text("Phút phải là số.")})}})},isNumber:function(i){return"[object Array]"!==Object.prototype.toString.call(i)&&!isNaN(parseFloat(i))&&isFinite(i)},LoadCaptchaError:function(){$.post(BASE_URL+"/captcha/get-link.html?field=error",function(){}).success(function(i){$("#errorCaptcha_report").attr({src:i})})},MoviePlay:function(){return HDV.V2.Info.InitSizePlayer(),$(".boxplay").click(function(){return HDV.V2.Info.CheckTrailerAndPlay(),!1}),"#pl"==window.location.hash&&HDV.V2.Info.CheckTrailerAndPlay(),!1},CheckFlashInstalled:function(){try{if(new ActiveXObject("ShockwaveFlash.ShockwaveFlash"))return!0}catch(i){if(navigator.mimeTypes&&void 0!=navigator.mimeTypes["application/x-shockwave-flash"]&&navigator.mimeTypes["application/x-shockwave-flash"].enabledPlugin)return!0}return!1},CheckTrailerAndPlay:function(){detailConfig.isTrailer?HDV.V2.Core.ShowNotice({title:"Thông báo",content:'<div>Bộ phim hiện chưa được trình chiếu.</div><br/><div align="center"><input type="submit"  class="mybutton click-to-view-trailer" value="XEM TRAILER"></div>',afterShow:function(){$(".click-to-view-trailer").click(function(){$.fancybox.close(),$("#bt-view-trailer").trigger("click")})}}):($(".boxplayer-popup").css({visibility:"visible"}),HDV.V2.Info.loadDataPlay(),gaEventHandling("Video Plays","Video Play",window.location.href),isHDVip&&gaEventHandling("Video Vip Plays","Video Play",window.location.href),$.ajax({beforeSend:function(i){i.setRequestHeader("Authorization","00000000000000000000000000000000")},type:"POST",url:"http://statistic.hdviet.com/api/v1/play",data:{movieId:detailConfig.mid,platform:1,product:1,action:"play"}}))},Init:function(){this.SetStylePage(),this.ShowTrailer(),this.Rating(),this.ClickPlay(),this.CheckFavoriteList(),this.AutoPlay(),this.SeasonPaging.Init(),this.LoadingEpisode.Config.mid=detailConfig.mid,this.LoadingEpisode.Init(),this.ToggleAds(),this.ErrorBox(),this.MoviePlay()}}}),$(document).ready(function(){NProgress.done(),HDV.V2.Info.Init()}),InventoryTag=function(){var i,e,t,a;i=(new Date).getTime(),e=document.createElement("script"),t="http://pq-direct.revsci.net/pql?placementIdList=aBSH0D&cb="+i,a=document.getElementsByTagName("script")[0],e.async=!0,e.onload=function(){if("undefined"!=typeof asiPlacements){void 0!==asiPlacements.aBSH0D&&void 0!==asiPlacements.aBSH0D.default&&(gwdTagDataAdGroup=asiPlacements.aBSH0D.default.key,gwdTagDataBlob=asiPlacements.aBSH0D.blob,gwdTagDataAdserver=asiAdserver);for(var i in asiPlacements){window["ASPQ_"+i]="";for(var e in asiPlacements[i].data)window["ASPQ_"+i]+="PQ_"+i+"_"+e}}},e.src=t,a.parentNode.insertBefore(e,a)};